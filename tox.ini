[tox]
envlist = py35-django22,py38-django{22,30}

[testenv]
setenv =
    DJANGO_SETTINGS_MODULE = edx_analytics_transformers.django.tests.settings
    PYTHONPATH = {toxinidir}

deps =
    -r{toxinidir}/requirements/test.txt

# These are the equivalent of 'make ci'.
commands =
    django22: pip install 'Django>=2.2,<2.3'
    django30: pip install 'Django>=3.0,<3.1'
    pytest --cov-report=html --cov-report term-missing --cov-branch -k 'not integration and not performance' --cov-fail-under=95 --cov=edx_analytics_transformers
    pytest --verbose -s -k 'integration'
    pycodestyle --config=setup.cfg edx_analytics_transformers setup.py
    pylint --rcfile=pylintrc edx_analytics_transformers setup.py
